\documentclass{article}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{csquotes}
\usepackage[hyphens]{url}
\usepackage{hyperref}
\theoremstyle{plain}
\Urlmuskip=0mu plus 1mu\relax

\title{A Novel Formula for Binomial Coefficients}
\author{Joseph M. Shunia}
\date{August 2023}

\newtheorem{thm}{Theorem}

\begin{document}

\maketitle

\begin{abstract}
Computing binomial coefficients is a fundamental problem in combinatorics and number theory, with applications across mathematics. The typical approach relies on factorials, Gamma functions, or Pascal's triangle. In this paper, we introduce a novel formula for binomial coefficients: \(\binom{n}{k} = \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}}\right\rfloor \bmod{2^{n}} \quad \text{for } n > 0 \text{ and } 0 \leq k \leq n\). We generalize the formula to multinomials, and discuss how it follows from a key property of polynomial interpolation rarely highlighted in textbooks. The simplicity of our arithmetic approach provides opportunities to develop more efficient algorithms and analyze computational complexity. Further, our formula establishes a new connection between binomial coefficients and modular arithmetic that may yield theoretical insights into their underlying mathematical foundations.
\end{abstract}

\section{Introduction}
Binomial coefficients, denoted as \(\binom{n}{k}\), are ubiquitous in mathematics. They quantify the number of distinct ways to select \(k\) elements from a set of \(n\) elements, irrespective of the order of selection. These coefficients permeate various branches of mathematics, from the coefficients in the expansion of a binomial equation to the calculation of probabilities in statistical theory. Traditional methods to compute binomial coefficients include the use of factorials, Gamma functions, or Pascal's triangle \cite{brualdi1992introductory}. Despite the prevalence of these methods, there is always room for fresh perspectives that can lead to novel insights and applications. In this paper, we hope to introduce such a perspective.
\\
\\
We present a new formula to compute binomial coefficients, given by:

\begin{equation}
\binom{n}{k} = \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}}\right\rfloor \bmod{2^{n}}, \quad \text{for } n > 0 \text{ and } 0 \leq k \leq n
\end{equation}
\\
This formula stems from a fascinating property of polynomials that has been rarely explored in mathematical literature. By connecting the computation of binomial coefficients with this polynomial property, we establish a formula that depends only on basic arithmetic operations. Our contribution is not just in offering an alternative computation method, but in unveiling a connection that may lead to further explorations and insights pertaining to binomial coefficients.

\section{Preliminaries and Definitions}

\subsection{Definition of Polynomial Function}
We define $P(x)$ as the polynomial function:
\begin{equation}
P(x) = 1 + x
\end{equation}
To denote $P(x)$ raised to the power of $n$, we write:
\begin{align*}
P(x)^{n} &= (1 + x)^{n} \\
&= a_n x^n + a_{n-1} x^{n-1} + \ldots + a_k x^k + \ldots + a_1 x + a_0
\end{align*}
\\
We define $P(x)^{n}_{k}$ to represent the coefficient of the $k$-th degree term in the polynomial expansion of $P(x)^{n}$, that is the value of $a_k$ in $a_k x^k$. Using this definition, we can write the polynomial expansion of $P(x)^{n}$ as the sum:
\begin{equation}
P(x)^{n} = \sum_{k=0}^{n} P(x)^{n}_{k} \cdot x^{k}
\end{equation}

\subsection{Polynomial Expansion and Binomial Coefficients}

If $n$ is a non-negative integer, then by the Binomial Theorem \cite{stewart2007calculus} we have:
\begin{equation}
P(x)^{n} = (1 + x)^{n} = \sum_{k=0}^{n} \binom{n}{k} x^{k}
\end{equation}
\\
Since we have defined $P(x)^{n}_{k}$ to represent the coefficient of the $k$-th degree term in the polynomial expansion of $P(x)^{n}$, it follows that:
\begin{equation}
P(x)^{n} = \sum_{k=0}^{n} P(x)^{n}_{k} \cdot x^{k} = \sum_{k=0}^{n} \binom{n}{k} x^{k}
\end{equation}
\\
As the coefficients of the terms in $P(x)$ are precisely the binomial coefficients for the $n$-th row of Pascal's Triangle \cite{rosen2011discrete}, it is apparent:
\begin{equation}
P(x)^{n}_{k} = \binom{n}{k}
\end{equation}

\subsection{Polynomial Interpolation}
Polynomial interpolation is the problem of constructing a polynomial $P(x)$ that passes through a given set of data points ${(x0, y0), (x1, y1), \ldots, (xn, yn)}$. That is, finding a polynomial $P(x)$ such that $P(xi) = yi$ for $i = 0, 1, \ldots, n$ \cite{burden2011numerical, kincaid2012numerical}.
\\
\\
There are various methods to interpolate polynomials, including Lagrange interpolation, Newton polynomial interpolation, and methods using divided differences \cite{burden2011numerical, kincaid2012numerical}. A fundamental result is that there exists a unique polynomial of degree \( n \) or less that interpolates \( n+1 \) data points \cite{burden2011numerical}. The key fact we require is that a polynomial is uniquely determined if we know its value at enough points. Specifically, if we know the value of \( P(x) \) at \( n+1 \) distinct inputs, then we can recover its terms, and therefore the coefficients \cite{cheney2013course}.
\\
\\
We will utilize a less known variant of this idea: that a polynomial can be unambiguously determined by evaluating just two carefully selected inputs \cite{arupinski,jcook}. This forms the basis for our subsequent derivations of formula for binomial coefficients and its generalization to multinomials.

\section{Derivation of the Formula}

\subsection{A Key Property of Polynomials}

\begin{thm}
\label{thm:1}
If $P(x)$ is a polynomial with non-negative integer coefficients, it can be completely determined by the values $P(1)$ and $P(P(1))$.
\end{thm}

\begin{proof}
Let $q = P(1)$, which gives the sum of the coefficients. Consider $P(P(1)) = P(q)$ expressed in base $q$; the digits correspond exactly to the coefficients of $P$. The only possible ambiguity arises if $P(q) = q\cdot n$ for some $n$, but since the coefficients sum to $q$, we deduce that $P = q \cdot x^{n-1}$ in this case \cite{arupinski}.
\end{proof}

\paragraph{\textbf{Remark.}}
This property appears to be underexplored in the literature; we were unable to find any papers explicitly describing it. However, it has been the subject of some online discussion and at least one blog post \cite{jcook}. The proof given above was first proposed by user ARupinski in a MathOverflow post \cite{arupinski} and has been slightly modified for the purposes of this paper.
\\
\\
The choice of $1$ as an input for $P(x)$ is not particularly special; if we replace $1$ with any non-zero integer, the proof will hold. This revelation enables us to observe that the theorem and its proof can be generalized to work with polynomials:

\begin{thm}
\label{thm:2}
If $P(x)$ is a polynomial with non-negative integer coefficients, and $Q(x)$ is any non-zero polynomial with integer coefficients, then $P(x)$ can be completely determined by the values $P(Q(1))$ and $P(P(Q(1)))$.
\end{thm}
\begin{proof}
Let $q = P(Q(1))$, which gives the sum of the coefficients of $P$ evaluated at $Q(1)$. Consider $P(P(Q(1))) = P(q)$ expressed in base $q$; the digits correspond exactly to the coefficients of $P$. The only possible ambiguity arises if $P(q) = q\cdot n$ for some $n$, but since the coefficients evaluated at $Q(1)$ sum to $q$, we deduce that $P = q \cdot x^{n-1}$ in this case.
\end{proof}

\subsection{Application of the Polynomial Property}
The value of $P(1)^{n}$ is simply the summation of the coefficients of $P(x)^{n}$. It is easy to see that:
\begin{equation}
P(1)^{n} = \sum_{k=0}^{n} \binom{n}{k} 1^{k} = (1 + 1)^{n} = 2^{n}
\end{equation}
\begin{align}
P(P(1)^{n})^{n} &= \sum_{k=0}^{n} \binom{n}{k} (P(1)^{n})^{k} = (1 + P(1)^{n})^{n} \\
&= \sum_{k=0}^{n} \binom{n}{k} (2^{n})^{k} = (1 + 2^{n})^{n}
\end{align}
\\
We can now use Theorem \ref{thm:1} to recover the coefficients of $P(x)^{n}$. We will achieve this by first encoding $P(P(1)^{n})^{n}$ in base $P(1)^{n}$, and then recovering the coefficients of $P(x)^n$ from the encoded value.

\subsection{Reconstruction of Polynomial Coefficients}

\begin{thm}
\label{thm:3}
The formula to recover the $k$-th coefficient of $P(x)^{n}$ is given by:
\begin{equation}
P(x)^{n}_{k} = \left\lfloor\frac{(1 + P(1)^{n})^{n} \bmod P(1)^{n k + n}}{P(1)^{n k}}\right\rfloor
\end{equation}
\end{thm}

\begin{proof}
Given an integer $n$ and a base $b > 1$. Let $L = \lfloor \log_b{n} \rfloor$. Then the encoded representation of $n$ in base $b$ is the unique representation of $n$, such that \cite{cormen2009introduction}:
\begin{equation}
n = \sum_{k=0}^{L} b^{k} \left\lfloor\frac{n \bmod b^{k+1}}{b^{k}}\right\rfloor 
\end{equation}
By inserting $P(1)$ into the equation, we can see:
\begin{align}
    P(x)^{n}_{k} &= \left\lfloor\frac{P(P(1)^{n})^{n} \bmod (P(1)^{n})^{k+1}}{(P(1)^{n})^{k}}\right\rfloor \\
    &= \left\lfloor\frac{(1 + P(1)^{n})^{n} \bmod P(1)^{n k + n}}{P(1)^{n k}}\right\rfloor
\end{align}
Hence, the theorem is proven.
\end{proof}

\subsection{Main Theorem and Its Proof}

\begin{thm}
\label{thm:4}
\begin{equation}
\binom{n}{k} = \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}}\right\rfloor \bmod{2^{n}}, \quad \text{for } n > 0 \text{ and } 0 \leq k \leq n
\end{equation}
\end{thm}
\begin{proof}
\textbf{Step 1: Proof that the equation is valid:} \\
We begin with the identity we established in Theorem \ref{thm:3}:
\begin{align}
 P(x)^{n}_{k} = \left\lfloor\frac{(1 + P(1)^{n})^{n} \bmod P(1)^{n k + n}}{P(1)^{n k}}\right\rfloor
\end{align}
By substituting $P(x)^{n}_{k} = \binom{n}{k}$ and $P(1) = 2$, we have: 
\begin{align}
\binom{n}{k} = \left\lfloor\frac{(1 + 2^{n})^{n} \bmod 2^{n k + n}}{2^{n k}}\right\rfloor
\end{align}
Next, we define $X = (1 + 2^{n})^{n}$, $Y = 2^{n k + n}$, $Z = 2^{n k}$. By replacement:
\begin{align}
\binom{n}{k} &= \left\lfloor\frac{X \bmod Y}{Z}\right\rfloor
\end{align}
To simplify the expression, we can utilize the following well-known identity for the mod operation \cite{niven2008introduction}:
\begin{align}
\label{modidentity}
a \bmod{b} = a - b \left\lfloor \frac{a}{b} \right\rfloor
\end{align}
By application of the identity, the expression simplifies as follows:
\begin{align}
\binom{n}{k} &= \left\lfloor\frac{X \bmod Y}{Z}\right\rfloor\\ &= \left\lfloor\frac{X - Y \left\lfloor \frac{X}{Y} \right\rfloor}{Z}\right\rfloor\\ &= \left\lfloor\frac{X}{Z} - \frac{Y}{Z} \left\lfloor \frac{X}{Y} \right\rfloor\right\rfloor
\end{align}
Next, we replace $X$, $Y$, and $Z$ with their respective values and simplify further:
\begin{align}
\binom{n}{k} &= \left\lfloor\frac{X}{Z} - \frac{Y}{Z} \left\lfloor \frac{X}{Y} \right\rfloor\right\rfloor \\ 
&= \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}} - \frac{2^{n k + n}}{2^{n k}} \left\lfloor \frac{(1 + 2^{n})^{n}}{2^{n k + n}} \right\rfloor\right\rfloor \\
&= \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}} - 2^{n} \left\lfloor \frac{(1 + 2^{n})^{n}}{2^{n k + n}} \right\rfloor\right\rfloor \\
&= \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}}\right\rfloor - 2^{n} \left\lfloor \frac{(1 + 2^{n})^{n}}{2^{n k + n}} \right\rfloor
\end{align}
Finally, we again make use of the mod operation identity (\ref{modidentity}) to simplify:
\begin{align}
\binom{n}{k} = \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}}\right\rfloor \bmod{2^{n}}
\end{align}
We have arrived at our formula.
\\
\\
\textbf{Step 2: Proof that the equation holds only for $n > 0$ and $0 \leq k \leq n$:}
\\
To prove why the equation $\binom{n}{k} = \left\lfloor\frac{(1 + 2^n)^n}{2^{nk}}\right\rfloor \bmod{2^n}$ holds only for $n > 0$ and $0 \leq k \leq n$, we consider the following cases:

\begin{enumerate}
\item $n \leq 0$: In this case, the modulus becomes $2^{-n}$ and the original equation does not make sense.

\item $k < 0$: In this case, we have $2^{-nk} = \frac{1}{2^{nk}}$ and the original expression becomes $2^{nk} (1 + 2^n)^n \bmod{2^n}$, which is always equal to $0$ since $2^{n} \mid 2^{nk}$.

\item $k > n$: In this case, $2^{nk} > (1 + 2^n)^n > 2^{nn}$, hence $\left\lfloor\frac{(1 + 2^n)^n}{2^{nk}}\right\rfloor = 0$. We note that $\binom{n}{k} = \binom{k}{n}$ here, which cannot equal $0$.
\end{enumerate}
\noindent
\textbf{Conclusion:}
\\
We have shown that our formula is valid and that it holds only for $n > 0$ and $0 \leq k \leq n$. Hence, the theorem is proven.
\end{proof}

\subsection{Close Inspection of Our Formula}
Upon initial inspection, it may not be obvious why our formula works:
\begin{align*}
\binom{n}{k} = \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}}\right\rfloor \bmod{2^{n}}, \quad \text{for } n > 0 \text{ and } 0 \leq k \leq n
\end{align*}
However, by expanding the numerator $(1 + 2^{n})^{n}$, we can see:
\begin{align}
(1 + 2^{n})^{n} = \sum_{j=0}^{n} \binom{n}{j} \cdot (2^n)^{j}
\end{align}
Dividing by the denominator $2^{n k}$ and taking the sum modulo $2^n$ gives:
\begin{align}
\frac{(1 + 2^{n})^{n}}{2^{n k}} \bmod{2^n} = \sum_{j=0}^{n} \binom{n}{j} \cdot (2^n)^{j-k} \bmod{2^n}
\end{align}
The terms with $j < k$ will sum to a value that is less than $1$ and therefore, will vanish upon application of the floor operation. The terms with $j > k$ will be divisible by $2^n$ and therefore, vanish upon application of the mod operation. The only remaining term is $j = k$, which is equal to $\binom{n}{k}$ since $(2^n)^{j-k} = (2^n)^0 = 1$.

\section{Generalization to Coefficients in the Multinomial Expansion of Univariate Polynomials}
\subsection{Notation for Coefficients}
We introduce a simplified notation to represent coefficients in the multinomial expansion of univariate polynomials. To denote the coefficient of the term with degree \( k \) in the polynomial expansion of \( (1 + x + \ldots + x^D)^n \), we write:

\[ \underline{D}\binom{n}{k} \]

\subsection*{Examples}
\begin{enumerate}
\item For the binomial expansion \( (1+x)^n \), the coefficient of the term \( x^k \) can be denoted as \( \underline{1}\binom{n}{k} \). This is equivalent to the conventional binomial coefficient \( \binom{n}{k} \).

\item For the trinomial expansion \( (1+x+x^2)^n \), the coefficient of the term \( x^k \) can be represented as \(\underline{2}\binom{n}{k}\).
\end{enumerate}

\subsection{Generalized Formula and Its Proof}

\begin{thm}
\label{thm:5}
\begin{align}
\underline{D}\binom{n}{k} = \left\lfloor \left(\frac{(D+1)^{nD+n} - 1}{(D+1)^{n} - 1}\right)^n \cdot (D + 1)^{-n k}\right\rfloor \bmod (D + 1)^n, \\ \quad \text{for } n > 0 \text{ and } 0 \leq k \leq nD
\end{align}
\end{thm}
\begin{proof}
\textbf{Step 1: Proof that the equation is valid:} \\
We define the polynomial function:
\begin{equation}
P(x,D)^n = (1 + x + \ldots + x^D)^n
\end{equation}
In this case, it is clear that:
\begin{equation}
P(1,D)^n = (D + 1)^n
\end{equation}
Therefore, we have:
\begin{equation}
P(P(1,D)^n,D)^n = (1 + (D+1)^n + \ldots + (D+1)^{n D})^n
\end{equation}
Observe that the inner sum is equivalent to the summation of the powers of $(D+1)^n$ from $0$ to $D$. We note the following identity \cite{A023037}:
\begin{equation}
\sum_{k=0}^{n-1} n^k = \frac{n^{n} - 1}{n - 1}
\end{equation}
By substitution, we have:
\begin{equation}
P(P(1,D)^n,D)^n = \left(\sum_{k=0}^{D} (D+1)^{nk}\right)^n = \left(\frac{(D+1)^{nD+n} - 1}{(D+1)^{n} - 1}\right)^n
\end{equation}
In of our proof of Theorem \ref{thm:4}, we established that:
\begin{equation}
\binom{n}{k} = \left\lfloor\frac{P(P(1)^n)^{n}}{P(1)^{n k}}\right\rfloor \bmod{P(1)^{n}}
\end{equation}
By equivalence, we have:
\begin{equation}
\underline{D}\binom{n}{k} = \left\lfloor\frac{P(P(1,D)^n,D)^{n}}{P(1,D)^{n k}}\right\rfloor \bmod{P(1,D)^{n}}
\end{equation}
Finally, we replace the values of $P(1,D)^n$ and $P(P(1,D)^n,D)^n$ to arrive at our original equation:
\begin{equation}
\underline{D}\binom{n}{k} = \left\lfloor \left(\frac{(D+1)^{nD+n} - 1}{(D+1)^{n} - 1}\right)^n \cdot (D + 1)^{-n k}\right\rfloor \bmod (D + 1)^n
\end{equation}
\textbf{Step 2: Proof that the equation holds only for $n > 0$ and $0 \leq k \leq nD$:} \\
To prove why the equation holds only for $n > 0$ and $0 \leq k \leq nD$, we consider the following cases:
\begin{enumerate}
\item $n \leq 0$: In this case, the modulus becomes $(D+1)^{-n}$ and the original equation does not make sense.
\item $k < 0$: In this case, we have $(D+1)^{-(-nk)} = (D+1)^{nk}$ and thus the original expression is always equal to $0$, since $(D+1)^{n} \mid (D+1)^{nk}$.
\item $k > nD$: In this case, $(D+1)^{nk} > \left(\frac{(D + 1)^{n D + n} - 1}{(D + 1)^{n} - 1}\right)^{n} > (D+1)^{nn}$, so the value of the expression is always equal to $0$.
\end{enumerate}
\noindent
\textbf{Conclusion:}
\\
We have shown that our formula is valid and that it holds only for $n > 0$ and $0 \leq k \leq nD$. Hence, the theorem is proven.
\end{proof}

\section{Summary}
In this paper, we have made two key contributions. First, we derived and proved a novel formula for computing binomial coefficients:
\begin{align*}
\binom{n}{k} = \left\lfloor\frac{(1 + 2^{n})^{n}}{2^{n k}}\right\rfloor \bmod{2^{n}} \quad \text{for } n > 0 \text{ and } 0 \leq k \leq n
\end{align*}
\\
This formula depends only on basic arithmetic operations and establishes an interesting connection between binomial coefficients and modular arithmetic. 
\\
Second, we generalized this formula to find closed form expressions for the coefficients of terms in the multinomial expansion of arbitrary degree univariate polynomials. Specifically, we showed:
\begin{align*}
\underline{D}\binom{n}{k} = \left\lfloor \left(\frac{(D+1)^{nD+n} - 1}{(D+1)^{n} - 1}\right)^n \cdot (D + 1)^{-n k}\right\rfloor \bmod (D + 1)^n, \\ \text{for } n > 0 \text{ and } 0 \leq k \leq nD
\end{align*}
\\
Where \(\underline{D}\binom{n}{k}\) denotes the coefficient of the term with degree \(k\) in the expansion of \((1+x+\ldots+x^D)^n\).
\\
\\
Our novel approach stems from connecting binomial coefficients to a key, but rarely explored, property of polynomials: that they can be unambiguously determined by two judiciously chosen inputs. This insight allowed us to derive simple arithmetic formulas for computing these coefficients. In doing so, our work strengthens the connection between binomial coefficients and polynomial functions, while also establishing an elegant new link to modular arithmetic. This link is not only mathematically appealing, but also ripe with potential for further exploration. Our formula serves not merely as an alternative means to compute binomial coefficients, but as a potential pathway to new mathematical identities and relations between these fundamental concepts.
\\
\\
Discoveries such as ours underscore the idea that profound insights can often emerge from concepts that, once discovered, seem simple and obvious, yet have remained overlooked. We hope that this reminds others of the vast potential for innovation that still lies latent even within well-studied fields of mathematics. By revisiting old problems with fresh perspectives, there is always the possibility of unearthing powerful new insights.

\section{Future Directions}
Future research could explore the computational efficiency of the formulas and their behavior for large values of \(n\), \(k\), and \(D\) with a view to potential optimizations. Further investigation into the polynomial property and its generalization could potentially reveal applications in computing values of other sequences. An examination of the relationship between modular arithmetic and binomial coefficients also presents a promising avenue for exploration.

\bibliographystyle{unsrt}
\bibliography{main}

\end{document}